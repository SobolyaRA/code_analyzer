package org.example.vulnerability;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

public class XXEVulnerable {
    public void parseXML(String xml) throws Exception {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
        DocumentBuilder builder = factory.newDocumentBuilder();
        builder.parse(xml);

        DocumentBuilderFactory factory2 = DocumentBuilderFactory.newInstance();
        factory2.setFeature("http://xml.org/sax/features/external-general-entities", true);
        DocumentBuilder builder2 = factory2.newDocumentBuilder();
        builder2.parse(xml);
    }
}



